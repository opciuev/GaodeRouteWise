<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ­£ç¡®çš„é«˜å¾·APIä½¿ç”¨æ–¹æ³•</title>
    <script>
        window._AMapSecurityConfig = {
            securityJsCode: "db2b6cf5ae4f82ee233b1abe16aa459a",
        }
    </script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .result { background: #f8f9fa; padding: 15px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #007bff; white-space: pre-wrap; }
        .success { border-left-color: #28a745; }
        .error { border-left-color: #dc3545; }
        input { padding: 8px; margin: 5px; border: 1px solid #ddd; border-radius: 4px; width: 300px; }
        #map { width: 100%; height: 400px; border: 1px solid #ddd; margin: 10px 0; }
        .code-example { background: #f8f9fa; padding: 15px; border-radius: 5px; font-family: monospace; font-size: 12px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ æ­£ç¡®çš„é«˜å¾·åœ°å›¾APIä½¿ç”¨æ–¹æ³•</h1>
        <p>æ ¹æ®å®˜æ–¹æ–‡æ¡£ <a href="https://lbs.amap.com/api/javascript-api/reference/route-search" target="_blank">è·¯å¾„è§„åˆ’å‚è€ƒæ‰‹å†Œ</a> çš„æ­£ç¡®ç”¨æ³•</p>
        
        <div>
            <h3>1. åŠ è½½API</h3>
            <input type="password" id="apiKey" placeholder="è¾“å…¥APIå¯†é’¥">
            <button onclick="loadAPI()">åŠ è½½API</button>
            <div id="apiResult" class="result">è¯·è¾“å…¥APIå¯†é’¥</div>
        </div>

        <div>
            <h3>2. åˆ›å»ºåœ°å›¾</h3>
            <button onclick="createMap()">åˆ›å»ºåœ°å›¾</button>
            <div id="map"></div>
            <div id="mapResult" class="result">è¯·å…ˆåŠ è½½API</div>
        </div>

        <div>
            <h3>3. é©¾è½¦è·¯çº¿è§„åˆ’ï¼ˆæŒ‰å…³é”®å­—ï¼‰</h3>
            <p>å®˜æ–¹æ–‡æ¡£æ¨èæ ¼å¼ï¼š</p>
            <div class="code-example">
// ä½¿ç”¨å…³é”®å­—æ•°ç»„æ ¼å¼
const points = [
    {keyword:'åŒ—äº¬å—ç«™', city:'åŒ—äº¬å¸‚'},
    {keyword:'åŒ—äº¬è¥¿ç«™', city:'åŒ—äº¬å¸‚'}
];
driving.search(points, callback);
            </div>
            <input type="text" id="origin1" value="å¤©å®‰é—¨" placeholder="èµ·ç‚¹å…³é”®å­—">
            <input type="text" id="destination1" value="åŒ—äº¬è¥¿ç«™" placeholder="ç»ˆç‚¹å…³é”®å­—">
            <button onclick="testDrivingByKeyword()">æŒ‰å…³é”®å­—è§„åˆ’</button>
            <div id="result1" class="result">è¯·å…ˆåˆ›å»ºåœ°å›¾</div>
        </div>

        <div>
            <h3>4. é©¾è½¦è·¯çº¿è§„åˆ’ï¼ˆæŒ‰åæ ‡ï¼‰</h3>
            <p>å®˜æ–¹æ–‡æ¡£åæ ‡æ ¼å¼ï¼š</p>
            <div class="code-example">
// ä½¿ç”¨åæ ‡æ ¼å¼
const origin = new AMap.LngLat(116.379028, 39.865042);
const destination = new AMap.LngLat(116.427281, 39.903719);
driving.search(origin, destination, callback);
            </div>
            <button onclick="testDrivingByCoords()">æŒ‰åæ ‡è§„åˆ’ï¼ˆå¤©å®‰é—¨â†’åŒ—äº¬è¥¿ç«™ï¼‰</button>
            <div id="result2" class="result">è¯·å…ˆåˆ›å»ºåœ°å›¾</div>
        </div>

        <div>
            <h3>5. æ­¥è¡Œè·¯çº¿è§„åˆ’</h3>
            <button onclick="testWalking()">æ­¥è¡Œè·¯çº¿è§„åˆ’</button>
            <div id="result3" class="result">è¯·å…ˆåˆ›å»ºåœ°å›¾</div>
        </div>

        <div>
            <h3>6. å…¬äº¤è·¯çº¿è§„åˆ’</h3>
            <button onclick="testTransfer()">å…¬äº¤è·¯çº¿è§„åˆ’</button>
            <div id="result4" class="result">è¯·å…ˆåˆ›å»ºåœ°å›¾</div>
        </div>
    </div>

    <script>
        let AMap;
        let map;

        function loadAPI() {
            const key = document.getElementById('apiKey').value.trim();
            const result = document.getElementById('apiResult');
            
            if (!key) {
                result.innerHTML = 'âŒ è¯·è¾“å…¥APIå¯†é’¥';
                result.className = 'result error';
                return;
            }

            result.innerHTML = 'ğŸ”„ æ­£åœ¨åŠ è½½API...';
            result.className = 'result';

            const script = document.createElement('script');
            script.src = `https://webapi.amap.com/maps?v=1.4.15&key=${key}`;
            
            script.onload = () => {
                if (window.AMap) {
                    AMap = window.AMap;
                    result.innerHTML = 'âœ… APIåŠ è½½æˆåŠŸï¼';
                    result.className = 'result success';
                } else {
                    result.innerHTML = 'âŒ APIå¯¹è±¡æœªæ‰¾åˆ°';
                    result.className = 'result error';
                }
            };
            
            script.onerror = () => {
                result.innerHTML = 'âŒ ç½‘ç»œé”™è¯¯ï¼Œæ— æ³•åŠ è½½API';
                result.className = 'result error';
            };
            
            document.head.appendChild(script);
        }

        function createMap() {
            const result = document.getElementById('mapResult');
            
            if (!AMap) {
                result.innerHTML = 'âŒ è¯·å…ˆåŠ è½½API';
                result.className = 'result error';
                return;
            }

            try {
                map = new AMap.Map('map', {
                    zoom: 11,
                    center: [116.397428, 39.90923]
                });
                
                result.innerHTML = 'âœ… åœ°å›¾åˆ›å»ºæˆåŠŸï¼';
                result.className = 'result success';
            } catch (error) {
                result.innerHTML = 'âŒ åœ°å›¾åˆ›å»ºå¤±è´¥: ' + error.message;
                result.className = 'result error';
            }
        }

        function testDrivingByKeyword() {
            const result = document.getElementById('result1');
            const origin = document.getElementById('origin1').value.trim();
            const destination = document.getElementById('destination1').value.trim();
            
            if (!AMap || !map) {
                result.innerHTML = 'âŒ è¯·å…ˆåˆ›å»ºåœ°å›¾';
                result.className = 'result error';
                return;
            }

            result.innerHTML = 'ğŸ”„ æ­£åœ¨è§„åˆ’è·¯çº¿ï¼ˆæŒ‰å…³é”®å­—ï¼‰...';
            result.className = 'result';

            AMap.plugin('AMap.Driving', function() {
                const driving = new AMap.Driving({
                    map: map,
                    panel: null
                });
                
                // æŒ‰ç…§å®˜æ–¹æ–‡æ¡£æ ¼å¼ä½¿ç”¨å…³é”®å­—æ•°ç»„
                const points = [
                    {keyword: origin, city: 'åŒ—äº¬å¸‚'},
                    {keyword: destination, city: 'åŒ—äº¬å¸‚'}
                ];
                
                driving.search(points, function(status, routeResult) {
                    if (status === 'complete' && routeResult.routes && routeResult.routes.length > 0) {
                        const route = routeResult.routes[0];
                        result.innerHTML = `âœ… é©¾è½¦è·¯çº¿è§„åˆ’æˆåŠŸï¼ˆæŒ‰å…³é”®å­—ï¼‰ï¼
èµ·ç‚¹: ${routeResult.start ? routeResult.start.name : origin}
ç»ˆç‚¹: ${routeResult.end ? routeResult.end.name : destination}
è·ç¦»: ${(route.distance / 1000).toFixed(1)}å…¬é‡Œ
æ—¶é—´: ${Math.round(route.time / 60)}åˆ†é’Ÿ
è´¹ç”¨: Â¥${route.tolls || 0}`;
                        result.className = 'result success';
                    } else {
                        result.innerHTML = `âŒ è·¯çº¿è§„åˆ’å¤±è´¥
çŠ¶æ€: ${status}
é”™è¯¯ä¿¡æ¯: ${routeResult ? routeResult.info || 'æœªçŸ¥é”™è¯¯' : 'æ— å“åº”'}`;
                        result.className = 'result error';
                    }
                });
            });
        }

        function testDrivingByCoords() {
            const result = document.getElementById('result2');
            
            if (!AMap || !map) {
                result.innerHTML = 'âŒ è¯·å…ˆåˆ›å»ºåœ°å›¾';
                result.className = 'result error';
                return;
            }

            result.innerHTML = 'ğŸ”„ æ­£åœ¨è§„åˆ’è·¯çº¿ï¼ˆæŒ‰åæ ‡ï¼‰...';
            result.className = 'result';

            AMap.plugin('AMap.Driving', function() {
                const driving = new AMap.Driving({
                    map: map,
                    panel: null
                });
                
                // æŒ‰ç…§å®˜æ–¹æ–‡æ¡£æ ¼å¼ä½¿ç”¨åæ ‡
                const origin = new AMap.LngLat(116.397428, 39.90923); // å¤©å®‰é—¨
                const destination = new AMap.LngLat(116.322287, 39.893729); // åŒ—äº¬è¥¿ç«™
                
                driving.search(origin, destination, function(status, routeResult) {
                    if (status === 'complete' && routeResult.routes && routeResult.routes.length > 0) {
                        const route = routeResult.routes[0];
                        result.innerHTML = `âœ… é©¾è½¦è·¯çº¿è§„åˆ’æˆåŠŸï¼ˆæŒ‰åæ ‡ï¼‰ï¼
èµ·ç‚¹åæ ‡: ${origin.lng}, ${origin.lat}
ç»ˆç‚¹åæ ‡: ${destination.lng}, ${destination.lat}
è·ç¦»: ${(route.distance / 1000).toFixed(1)}å…¬é‡Œ
æ—¶é—´: ${Math.round(route.time / 60)}åˆ†é’Ÿ
è´¹ç”¨: Â¥${route.tolls || 0}`;
                        result.className = 'result success';
                    } else {
                        result.innerHTML = `âŒ è·¯çº¿è§„åˆ’å¤±è´¥
çŠ¶æ€: ${status}
é”™è¯¯ä¿¡æ¯: ${routeResult ? routeResult.info || 'æœªçŸ¥é”™è¯¯' : 'æ— å“åº”'}`;
                        result.className = 'result error';
                    }
                });
            });
        }

        function testWalking() {
            const result = document.getElementById('result3');
            
            if (!AMap || !map) {
                result.innerHTML = 'âŒ è¯·å…ˆåˆ›å»ºåœ°å›¾';
                result.className = 'result error';
                return;
            }

            result.innerHTML = 'ğŸ”„ æ­£åœ¨è§„åˆ’æ­¥è¡Œè·¯çº¿...';
            result.className = 'result';

            AMap.plugin('AMap.Walking', function() {
                const walking = new AMap.Walking({
                    map: map,
                    panel: null
                });
                
                // ä½¿ç”¨åæ ‡
                const origin = new AMap.LngLat(116.397428, 39.90923); // å¤©å®‰é—¨
                const destination = new AMap.LngLat(116.322287, 39.893729); // åŒ—äº¬è¥¿ç«™
                
                walking.search(origin, destination, function(status, walkResult) {
                    if (status === 'complete' && walkResult.routes && walkResult.routes.length > 0) {
                        const route = walkResult.routes[0];
                        result.innerHTML = `âœ… æ­¥è¡Œè·¯çº¿è§„åˆ’æˆåŠŸï¼
è·ç¦»: ${(route.distance / 1000).toFixed(1)}å…¬é‡Œ
æ—¶é—´: ${Math.round(route.time / 60)}åˆ†é’Ÿ`;
                        result.className = 'result success';
                    } else {
                        result.innerHTML = `âŒ æ­¥è¡Œè·¯çº¿è§„åˆ’å¤±è´¥
çŠ¶æ€: ${status}
é”™è¯¯ä¿¡æ¯: ${walkResult ? walkResult.info || 'æœªçŸ¥é”™è¯¯' : 'æ— å“åº”'}`;
                        result.className = 'result error';
                    }
                });
            });
        }

        function testTransfer() {
            const result = document.getElementById('result4');
            
            if (!AMap || !map) {
                result.innerHTML = 'âŒ è¯·å…ˆåˆ›å»ºåœ°å›¾';
                result.className = 'result error';
                return;
            }

            result.innerHTML = 'ğŸ”„ æ­£åœ¨è§„åˆ’å…¬äº¤è·¯çº¿...';
            result.className = 'result';

            AMap.plugin('AMap.Transfer', function() {
                const transfer = new AMap.Transfer({
                    map: map,
                    panel: null,
                    city: 'åŒ—äº¬'
                });
                
                // ä½¿ç”¨åæ ‡
                const origin = new AMap.LngLat(116.397428, 39.90923); // å¤©å®‰é—¨
                const destination = new AMap.LngLat(116.322287, 39.893729); // åŒ—äº¬è¥¿ç«™
                
                transfer.search(origin, destination, function(status, transferResult) {
                    if (status === 'complete' && transferResult.plans && transferResult.plans.length > 0) {
                        const plan = transferResult.plans[0];
                        result.innerHTML = `âœ… å…¬äº¤è·¯çº¿è§„åˆ’æˆåŠŸï¼
è·ç¦»: ${(plan.distance / 1000).toFixed(1)}å…¬é‡Œ
æ—¶é—´: ${Math.round(plan.time / 60)}åˆ†é’Ÿ
è´¹ç”¨: Â¥${plan.cost || 0}`;
                        result.className = 'result success';
                    } else {
                        result.innerHTML = `âŒ å…¬äº¤è·¯çº¿è§„åˆ’å¤±è´¥
çŠ¶æ€: ${status}
é”™è¯¯ä¿¡æ¯: ${transferResult ? transferResult.info || 'æœªçŸ¥é”™è¯¯' : 'æ— å“åº”'}`;
                        result.className = 'result error';
                    }
                });
            });
        }
    </script>
</body>
</html>
