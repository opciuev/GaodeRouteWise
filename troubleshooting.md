# 🔧 故障排除指南

## 常见问题及解决方案

### 1. 🚫 ERR_BLOCKED_BY_CLIENT 错误

**问题描述**: 控制台显示 `Failed to load resource: net::ERR_BLOCKED_BY_CLIENT`

**原因**: 广告拦截器（如 AdBlock、uBlock Origin）阻止了高德地图API的请求

**解决方案**:
1. **临时关闭广告拦截器**
   - 点击浏览器工具栏中的广告拦截器图标
   - 选择"在此网站上暂停"或"禁用"
   - 刷新页面

2. **将网站添加到白名单**
   - 在广告拦截器设置中添加 `localhost:8000` 到白名单
   - 或者添加 `*.amap.com` 到白名单

3. **使用无痕模式**
   - 打开浏览器无痕/隐私模式
   - 在无痕模式下访问应用

### 2. 📍 定位功能失败

**问题描述**: 浏览器定位返回 `undefined` 或失败

**可能原因及解决方案**:

#### A. 权限问题
- **现象**: 浏览器没有弹出位置权限请求
- **解决**: 
  1. 检查浏览器地址栏左侧是否有位置图标
  2. 点击位置图标，选择"允许"
  3. 在浏览器设置中手动允许位置权限

#### B. HTTPS要求
- **现象**: 在某些浏览器中HTTP协议下定位失败
- **解决**: 
  1. 使用HTTPS协议访问（推荐）
  2. 或者在Chrome中访问 `chrome://flags/#unsafely-treat-insecure-origin-as-secure`
  3. 添加 `http://localhost:8000` 到列表中

#### C. 设备不支持GPS
- **现象**: PC端定位精度低或失败
- **解决**: 使用IP定位作为替代方案

### 3. 🌐 IP定位失败

**问题描述**: IP定位无法获取城市信息

**解决方案**:
1. **检查网络连接**
2. **关闭VPN或代理**（可能影响IP定位准确性）
3. **等待片刻后重试**（服务可能暂时繁忙）

### 4. 🗺️ 地图无法显示

**问题描述**: 地图容器空白或显示错误

**解决方案**:
1. **检查API密钥**
   - 确保API密钥正确
   - 检查API密钥是否已启用JS API服务
   - 确认API密钥配额未超限

2. **检查网络连接**
   - 确保能访问 `webapi.amap.com`
   - 检查防火墙设置

3. **浏览器兼容性**
   - 使用现代浏览器（Chrome 60+, Firefox 55+, Safari 11+）
   - 启用JavaScript

### 5. 🚗 路线规划失败

**问题描述**: 无法获取路线规划结果

**解决方案**:
1. **地址格式**
   - 使用具体地址，包含城市名称
   - 例如："北京市朝阳区三里屯" 而不是 "三里屯"

2. **检查起终点**
   - 确保起终点都在中国大陆范围内
   - 避免使用过于模糊的地址

3. **网络问题**
   - 检查是否被广告拦截器阻止
   - 尝试刷新页面重新规划

## 🛠️ 调试技巧

### 1. 打开浏览器开发者工具
- **Windows**: `F12` 或 `Ctrl+Shift+I`
- **Mac**: `Cmd+Option+I`

### 2. 查看控制台错误
- 切换到 "Console" 标签页
- 查看红色错误信息
- 根据错误信息定位问题

### 3. 检查网络请求
- 切换到 "Network" 标签页
- 刷新页面，查看失败的请求
- 检查是否有被阻止的请求

## 🔧 环境要求

### 浏览器支持
- ✅ Chrome 60+
- ✅ Firefox 55+
- ✅ Safari 11+
- ✅ Edge 79+

### 协议要求
- ✅ HTTP (localhost开发环境)
- ✅ HTTPS (生产环境，推荐)

### 权限要求
- 📍 位置权限（用于精确定位）
- 🌐 网络访问权限

## 📞 获取帮助

如果问题仍然存在：

1. **检查API配额**
   - 登录 [高德开放平台控制台](https://console.amap.com/)
   - 查看API调用量是否超限

2. **查看官方文档**
   - [高德地图JS API文档](https://lbs.amap.com/api/javascript-api/summary)
   - [常见问题FAQ](https://lbs.amap.com/faq/js-api)

3. **联系技术支持**
   - 在高德开放平台提交工单
   - 提供详细的错误信息和复现步骤

## 🎯 最佳实践

1. **生产环境使用HTTPS**
2. **合理设置API调用频率**
3. **添加错误处理和用户提示**
4. **定期检查API配额使用情况**
5. **为用户提供备选方案**（如IP定位作为GPS定位的备选）
